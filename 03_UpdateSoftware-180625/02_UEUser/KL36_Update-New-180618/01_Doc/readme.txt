=================================================================
工程名称：AHL-IoT
版权所有：苏州大学arm嵌入式与物联网技术中心(sumcu.suda.edu.cn)
版本更新：V1.0,2017.8.16；V2.2，2018.1.6（WYH)
=================================================================

备注：LCD取模时应选择从左到右从上到下和横向8点右高位

1. 工程概述

       本工程为金葫芦AHL-IoT工程体系的MCU部分。主要完成终端UE对于数据的采集和发送任务。利用本工程
中的uecom构件可以轻松完成发送任务。利用本工程中的frame.h文件可以直接增删结构体中的变量。配合
AHL-IoT工程体系的用户服务器程序US，即可完成数据的增删操作。

2. 软件环境
(1)Kinetis Design Studio IDE v3.0.

3. 硬件环境
(1)AHL-IG-IoT SD-17-08 EVB板
(3)UART0对应PTE20~21，UART1对应PTE0~1，UART2对应PTE16~17
(4)PTA5对应红灯，PTA12对应绿灯，PTA13对应蓝灯
    
4. 实验现象

（1）利用盒内标准USB线，通过计算机、充电宝、手机充电器等USB接口给IoT套片供电，红灯亮，
LCD显示芯片温度“H0-xx.x”，时间约5秒。
（2）LCD显示UE的15位SIM卡号（IMSI号），如46004019380xxxx。分两屏显示，间隔5秒。IMSI号将
作为设备的唯一标识。
（3）LCD显示UE的通信模块的信号强度。显示提示“H1-xx”，其中xx为当前信号强度（百分比表示）。
xx在35以上时，通信较为流畅。若xx低于20，有可能无法正常通信。
（4）进入主循环，红灯每秒闪烁一次，LCD显示时间“hh.mm.ss”，每秒更新一次。在主循环运行过程中，
若按下触摸按键，则LCD显示“E1-x”，    x为TSI触摸次数。TSI每触摸3次或时间的分钟数为10的倍数时，
如：9:点40分。IoT套片将通过信息邮局MPO向人机交互系统HCI发送数据。上电默认时间为0时0分，为10
的整数倍，所以上电将立即发送一次数据。
（5）进入数据发送模式之后，首先显示“H1-1001”表示即将开始对通信模块的初始化。这个时间非常短暂，
正常不会看到。之后LCD显示“H1-1002”，表明正在对通信模块进行初始化，此过程耗时大约8-20秒。
请耐心等待数据发送过程中。若能成功与服务器建立连接，则在LCD上显示“H1-1003”，并在此之后以“
H1-xx”的形式将当前信号强度再次显示出来。之后LCD显示“H1-1004”表明终端UE正在进行组帧。组帧
完成之后，LCD显示“H1-1005”表明数据正在发送。若发送成功，LCD将显示“H1-1006”，并立即显示
“H1-1007”表明等待接收数据，大约等待40秒，若未接收到数据则显示“F1-3001”表明未接收到数据。
若接收到数据，则LCD提示“H1-1008”表示接收下行数据成功。并立即显示“H1-1009”表明正在解帧。
解帧完成之后，进入主循环，显示更新后的时间，并正常运行。
（6）若需获得运行过程信息，可使用串口通信方式（波特率：115200）。在PC机安装“..\04_Tools\TTL
-USB驱动”，通过TTL-USB线，将IoT套片UART2与PC机相连。使用“..\04_Tools\串口调试工具”
（注意选择波特率115200，并打开正确的com口）进行显示。

5.更新记录
20180403 wb
（1） AT命令返回数据的处理方式由查询更改为中断方式
（2） uecom中新增看门狗的支持
（3） 看门狗的开启或关闭操作放入了system_MKL36z4.c文件中，控制的宏变量ENABLE_WDOG移入wdog.h

=============================================================================
声明：
（1）我们开发的源代码，在本中心提供的硬件系统测试通过，真诚奉献给社会，不足之处，
欢迎指正。
（2）对于使用非本中心硬件系统的用户，移植代码时，请仔细根据自己的硬件匹配。

苏州大学嵌入式系统与物联网研究所
技术咨询：http://sumcu.suda.edu.cn;0512-65214835
